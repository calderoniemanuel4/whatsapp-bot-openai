# WhatsApp Bot en Google Cloud Functions (Gen2)

Bot de WhatsApp usando **Twilio Sandbox** + **OpenAI** desplegado en **Google Cloud Functions**.

---

## ‚úÖ Checklist de Deploy

### 1. Archivos del proyecto
- [ ] Crear `requirements.txt` con:
  ```txt
  functions-framework==3.5.0
  twilio==9.3.3
  openai==1.50.2
  httpx==0.27.2   # fijar versi√≥n para evitar error de proxies

 ### 2. Configuraci√≥n de GCP
	‚Ä¢	Seleccionar proyecto en la consola web o crear uno nuevo.
	‚Ä¢	Configurar en terminal:
    gcloud config set project PROJECT_ID
    Habilitar APIS:
    gcloud services enable cloudfunctions.googleapis.com run.googleapis.com artifactregistry.googleapis.com eventarc.googleapis.com cloudbuild.googleapis.com

### 3. Deploy de la funci√≥n
	‚Ä¢	Estar parado en la carpeta con main.py y requirements.txt.
	‚Ä¢	Ejecutar:
    gcloud functions deploy whatsapp-bot \
  --gen2 \
  --region=us-central1 \
  --runtime=python312 \
  --entry-point=webhook \
  --trigger-http \
  --allow-unauthenticated \
  --source . \
  --set-env-vars=OPENAI_API_KEY=sk-XXXX,OPENAI_MODEL=gpt-4o-mini

### 4. Probar que funciona
	‚Ä¢	Healthcheck:
    curl -X GET "https://REGION-PROJECT_ID.cloudfunctions.net/whatsapp-bot"
# ‚Üí ok
    *   Ping:
curl -X POST "https://REGION-PROJECT_ID.cloudfunctions.net/whatsapp-bot" -d "Body=ping"
# ‚Üí <Message>pong</Message>

### 5. Conectar con Twilio
	‚Ä¢	En Twilio Console ‚Üí WhatsApp Sandbox ‚Üí ‚ÄúWHEN A MESSAGE COMES IN‚Äù pegar la URL p√∫blica.
	‚Ä¢	Guardar cambios.
	‚Ä¢	Enviar WhatsApp al n√∫mero del Sandbox ‚Üí debe responder ‚úÖ.

‚∏ª

üõ†Ô∏è Tips r√°pidos
	‚Ä¢	Usar Python 3.12 (no 3.13).
	‚Ä¢	Fijar httpx==0.27.2 en requirements.txt.
	‚Ä¢	Si el deploy cachea, usar otro nombre de funci√≥n (whatsapp-bot-v2).
	‚Ä¢	Logs:
    gcloud functions logs read whatsapp-bot --gen2 --region=us-central1 --limit=100
    gcloud run services logs read whatsapp-bot --region=us-central1 --limit=100